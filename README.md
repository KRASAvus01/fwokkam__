# Project Title

## Table of Contents

- [О проекте](#Опроекте)
- [Начало](#Начало)

## About <a name = "about"></a>

Описание анализа данных

## Getting Started <a name = "getting_started"></a>

Краткий итог (что сделано)

Данные считаны из листа Raw data файла data_for_test.xlsx (дата: 2013-01-01 — 2015-02-01, дневной ряд; 762 строк; целевая переменная Y — количество звонков).

Провёл EDA (описательные статистики, корреляции, временные графики).

Перевёл данные в недельную агрегацию (стабильнее для MMM), реализовал adstock-преобразование для ТВ и OOH.

Подбор параметра decay для ТВ (по сетке) на тренировочной части (80% по времени).

Подобрал и построил OLS-модель для log1p(Y) с признаками: TV_ad (adstock), OOH_ad (adstock), Seasonal_Sales, Usd_rate, trend.

Валидация на отложенной части (последние 20% по времени).

Диагностика остатков и тесты (VIF, Durbin-Watson, Ljung-Box, ADF).

Количественная оценка влияния ТВ (эластичность на среднем уровне), интерпретация и рекомендации по улучшению модели.

1) Описание задачи и факторов (коротко)

Цель: построить регрессию, объясняющую/прогнозирующую звонки (Y) с помощью имеющихся факторов и оценить вклад рекламной активности на ТВ.

Признаки в файле: Date, Y, TV (показатель медиа-активности на ТВ), OOH (OTS наружной рекламы), Seasonal_Sales (нормированный сезонный фактор), Usd_rate (курс), плюс возможные производные строились (adstock, trend и т.д.).

2) Разведочный анализ (основные наблюдения)

Диапазон дат: 2013-01-01 — 2015-02-01. В ряде первых дней (1 января каждого года) Y отсутствует — эти строки удалены перед моделированием.

Распределение Y — сильный шум на ежедневном уровне; поэтому решение агрегировать в недели (109 недель) было принято для уменьшения шума и повышения устойчивости коэффициентов.

Корреляции (по недельным суммам): положительная связь Y с TV (корреляция ~ 0.27) и с Usd_rate (~0.31). OOH коррелирует с Y близко к нулю (слегка отрицательно).

Временной график (дневной) показал яркие всплески Y в отдельные дни и явные периоды с ТВ-активностью — эти даты отмечены на графике (точками). Видно несколько явных TV-кампаний (весна 2013, лето/осень 2014, декабрь 2014 — сильная активность).

Причина агрегации: дневной ряд очень шумный, weekly даёт более стабильную картину и более корректную оценку длительных эффектов рекламы (adstock).

3) Построенная модель — кратко

Агрегация: weekly (сумма звонков/спендов).

Adstock: реализовано для TV и OOH. Подбор decay для TV на тренировочной части (grid 0.0—0.9). Лучший decay ≈ 0.70 (по R² на тренировке). Для OOH использован фиктивный decay 0.5 (в примере — можно оптимизировать отдельно).

Модель: OLS на ln(1+Y) как зависимая переменная, признаков: TV_ad, OOH_ad, Seasonal_Sales, Usd_rate, trend.

Итоговые оценённые коэффициенты (обзор, модель на тренировке):

const ≈ 1.319

TV_ad β ≈ 3.747e-06, p < 0.001 (статистически значим)

OOH_ad β ≈ −2.809e-06, p ≈ 0.043 (статистически значим, отрицательный эффект)

Usd_rate β ≈ 0.0178, p < 0.001

trend β ≈ −0.0107, p < 0.001

R² на train ≈ 0.546, скорректированный R² ≈ 0.518.

4) Валидация (отложенная выборка)

Тест (последние 20% по времени) — прогнозы переводились обратно эксп(предсказание)-1.

Метрики на тесте (weekly):

RMSE ≈ 2043.4

MAE ≈ 1174.1

MAPE (на тесте) — очень большой (≈ 589%) — это сигнал того, что модель плохо прогнозирует некоторые пики (и/или чувствительна к масштабным изменениям переменных в тестовом периоде).

На графике наблюдаем, что модель адекватно описывает базовый уровень в train, но в test делает сильно завышенные прогнозы в последние недели — это вызвано резкими изменениями входных переменных (в частности Usd_rate растёт значительно в конце ряда), а модель учитывает Usd_rate сильно положительно, что ведёт к экспоненциальному влиянию из-за лог-преобразования.

5) Диагностика предпосылок и проблемы

Временная автокорреляция: Durbin-Watson ≈ 1.82 — не критично, но знак некоторой положительной автокорреляции присутствует. Ljung-Box для остатков (lags 4,8,12) — p-values большие → нет сильных признаков автокорреляции в остатках на выбранных лагах.

Стационарность остатков: ADF тест на остатки — p << 0.01 → остатки стационарны (хорошо).

Нормальность: Omnibus/Jarque-Bera дают p небольшие → остатки не идеально нормальны (есть некоторый скошенный/пик).

Мультиколлинеарность: VIF показал, что явной проблемы мультиколлинеарности среди применённых трансформированных признаков нет (TV_ad, OOH_ad — VIF ~1.5), но const и condition number большие → возможны численные проблемы/сильные масштабы признаков (Usd_rate и trend крупно влияют).

Проблема чекпойнта (extrapolation): в тестовой части наблюдаются резкие скачки Usd_rate и TV активности, которых не было в train — модель экстраполировалась, что и привело к большим ошибкам (чрезмерно большие предсказания).

Вывод: модель описательная и даёт статистически значимые коэффициенты, но недостаточно устойчива для надёжного автоматического прогноза в условиях сильных изменений входных ковариат (особенно Usd_rate) без дополнительных мер (регуляризация, ограничение влияния экстремальных значений, либо отдельная модель для экстремальных периодов).

6) Количественная оценка влияния ТВ (ответ на задачу d)

Коэффициент TV_ad в модели (для ln(1+Y)): β_TV ≈ 3.747e-06.

Среднее значение TV_ad в тренировке ≈ 20 472 (weekly, после adstock с decay=0.7).

Тогда приблизительная эластичность (d ln Y / d ln TV) в точке среднего:

elasticity_mean = β_TV * mean(TV_ad) ≈ 0.0767

Интерпретация: увеличение TV (в долгосрочном, adstock-усреднённом смысле) на 10% приводит к увеличению Y примерно на 0.77% (приблизительно).

Это — умеренная положительная отдача: ТВ даёт рост звонков, но эффект умеренный и убывает с учётом adstock/с насыщением.

7) Графики (сделано)

Дневной график Y с отмеченными днями ТВ-активности (красные точки).

Weekly: наблюдаемые и прогнозные значения (вертикальная линия показывает начало теста).

График остатков по времени.
(Все графики построены в ноутбуке — вы их видели в выводе исполнения.)

8) Интерпретация результатов и практические рекомендации

Что можно сказать по модели и данным:

ТВ оказывает статистически значимый положительный эффект на звонки; эластичность в районе 0.07—0.08 при средних значениях TV_ad — т.е. 10% прирост ТВ даёт ≈0.8% прирост звонков.

OOH в модели получился малым и даже отрицательным (p≈0.04). Это может означать либо: (a) OOH действительно неэффективен в регионе/периоде, (b) неправильно задана шкала/адсток для OOH, (c) OOH коррелирует с непересекаемыми событиями (например, периоды, когда снижались другие активности) — надо углубиться.

Usd_rate оказался сильным предиктором — возможно отражает макроэкономику/платёжеспособность и сильно влияет на Y (зависимость бизнеса от курса). 
